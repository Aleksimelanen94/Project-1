<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>To do list</title>
        <script src="toDoList.js"></script>
        <link rel="stylesheet" href="Design.css">
	</head>
	<body>
        <div class="header">
            <h1>To do list</h1>
        </div>

        <p>
            To do:
            <input type="text" name="toDo" id="toDo" maxlength="30">
            Time (optional): 
            <input type="time" name="time" id="time">

            <input type="button" onclick="addRow()" name="add" id="add" value="Add">
        </p>
        <div class="list">
            <ul id="toDoList">

            </ul>
        </div>

        <input type="button" onclick="clearList()" name="clear" id="clear" value="Clear list">
        
        <input type="button" onclick="SaveList()" name="saveButton" id="saveButton" value="Save">
        <input type="button" onclick="LoadList()" name="loadButton" id="loadButton" value="Load">
        <p class="listCounter"></p>
		<script>
                //add new row to to do list
                function addRow(){

                    var li = document.createElement("li");
                    var toDoInput = document.getElementById("toDo").value;
                    var toDoText = document.createTextNode(toDoInput + " " + time.value);
                    //toDoText.className = "liText";
                    li.appendChild(toDoText);
                    
                    //check if user textfield input is valid
                    if(toDoInput === "" || toDoInput.length < 4){
                        alert("Textfield is empty or invalid (input must be more than 4 characters long)");
                    }else{
                        document.getElementById("toDoList").appendChild(li);
                    }
                    document.getElementById("toDo").value = "";

                    //reset time value
                    var timeInput = document.getElementById("time");
                    timeInput.value = timeInput.defaultValue;
                    
                    //create checkbox to list item
                    var doneButton = document.createElement("input");
                    doneButton.type ="checkbox";
                    doneButton.className = "doneButton";
                    li.appendChild(doneButton);
                    //add Delete button to list item
                    var deleteButton = document.createElement("input");
                    deleteButton.type ="button";
                    deleteButton.className = "delete"
                    deleteButton.value ="X";
                    li.appendChild(deleteButton);
                    
                    //delete button function
                    var deleteButtons = document.getElementsByClassName("delete");
                        for (i = 0; i < deleteButtons.length; i++){
                            deleteButtons[i].onclick = function(){
                            var listItem = this.parentElement;
                            listItem.style.display = "none";
                        }
                    }
                }
                //clear all list items
                function clearList(){
                    var listItem = document.getElementsByName("li");
                    for(i = 0; i < listItem.length; i++){
                        listItem[i].style.display = "none";
                    }
                }

                function SaveList(){
                    var itemList = [];

                    var itemValues = document.querySelectorAll('li');
                    for(i = 0; i < itemValues.length; i++){
                        itemList.push(itemValues[i].childNodes[0].nodeValue);
                    }
                    console.log(itemList);
                    localStorage.setItem('items', JSON.stringify(itemList));
                    console.log(localStorage);
                }

                function LoadList(){
                    const storedList = JSON.parse(localStorage.getItem('items'));
                    console.log(storedvalue);
                }
        </script>
	</body>
</html>